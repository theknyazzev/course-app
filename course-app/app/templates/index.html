<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>ks study</title>
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div id="main-view" class="app-content view">
        <div class="search-container">
            <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫..." onclick="openSearch()">
        </div>

        <h2>–ß–¢–û –¢–´ –•–û–ß–ï–®–¨ –ó–ê–ú–ê–ù–¨–Ø–ß–ò–¢–¨?</h2>

        <div class="progress-section">
            <div class="progress-grid">
                <!-- –ü–µ—Ä–≤—ã–π —Ä—è–¥ -->
                <div class="progress-card" onclick="showVideos('html')">
                    <div class="progress-title">HTML + CSS</div>
                    <div class="progress-bar-container">
                        <div class="progress-text">
                            <span class="progress-label">–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                            <span class="progress-percent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="html-progress"></div>
                        </div>
                    </div>
                </div>

                <div class="progress-card" onclick="showVideos('js')">
                    <div class="progress-title">JavaScript</div>
                    <div class="progress-bar-container">
                        <div class="progress-text">
                            <span class="progress-label">–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                            <span class="progress-percent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="js-progress"></div>
                        </div>
                    </div>
                </div>

                <!-- –í—Ç–æ—Ä–æ–π —Ä—è–¥ -->
                <div class="progress-card" onclick="showVideos('php')">
                    <div class="progress-title">PHP</div>
                    <div class="progress-bar-container">
                        <div class="progress-text">
                            <span class="progress-label">–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                            <span class="progress-percent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="php-progress"></div>
                        </div>
                    </div>
                </div>

                <div class="progress-card" onclick="showVideos('wordpress')">
                    <div class="progress-title">WordPress</div>
                    <div class="progress-bar-container">
                        <div class="progress-text">
                            <span class="progress-label">–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                            <span class="progress-percent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="wp-progress"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
        <div class="calendar-container" id="calendar-container">
            <div class="calendar-content" id="calendar-content">
                <div class="calendar-header">
                    <div class="calendar-nav">
                        <button class="calendar-nav-button" onclick="changeMonth(-1)">‚Üê</button>
                        <button class="calendar-nav-button" onclick="changeMonth(1)">‚Üí</button>
                    </div>
                    <div>
                        <span class="calendar-month" id="current-month"></span>
                        <span class="calendar-year" id="current-year"></span>
                    </div>
                </div>
                <div class="calendar-grid" id="calendar-weekdays"></div>
                <div class="calendar-grid" id="calendar-days"></div>
            </div>
            <div class="calendar-swipe-area" id="swipe-area"></div>
        </div>

        <div class="divider"></div>

        <h2>–ù–ï–î–ê–í–ù–ï–ï –ù–ê –ö–ê–ù–ê–õ–ï:</h2>
        <div class="tag-filter">
            <div class="tag active" onclick="filterVideos('all')">–í—Å–µ</div>
            <div class="tag" onclick="filterVideos('html')">HTML + CSS</div>
            <div class="tag" onclick="filterVideos('js')">JavaScript</div>
            <div class="tag" onclick="filterVideos('php')">PHP</div>
            <div class="tag" onclick="filterVideos('wordpress')">WordPress</div>
        </div>

                <!-- –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–∏–¥–µ–æ (–¥–æ 5) -->
        <div class="recent-videos-container">
            <!-- –í–∏–¥–µ–æ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å –ø–æ–º–æ—â—å—é JavaScript -->
        </div>
    </div>

    <!-- –í–∏–¥–µ–æ —Ä–∞–∑–¥–µ–ª—ã - –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –∏–∑ –∞–¥–º–∏–Ω–∫–∏ -->
    <div id="videos-html" class="app-content hidden">
        <div class="back-button" onclick="hideVideos()">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
          <span>–ù–∞–∑–∞–¥</span>
        </div>
        <h2>HTML + CSS</h2>
        
        <div class="video-grid">
            <!-- –í–∏–¥–µ–æ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            <div class="loading-placeholder">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ...</div>
        </div>
    </div>

    <div id="videos-js" class="app-content hidden">
        <div class="back-button" onclick="hideVideos()">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
          <span>–ù–∞–∑–∞–¥</span>
        </div>
        <h2>JavaScript</h2>
        <div class="video-grid">
            <div class="loading-placeholder">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ...</div>
        </div>
    </div>

    <div id="videos-php" class="app-content hidden">
        <div class="back-button" onclick="hideVideos()">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
          <span>–ù–∞–∑–∞–¥</span>
        </div>
        <h2>PHP</h2>
        <div class="video-grid">
            <div class="loading-placeholder">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ...</div>
        </div>
    </div>

    <div id="videos-wordpress" class="app-content hidden">
        <div class="back-button" onclick="hideVideos()">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
          <span>–ù–∞–∑–∞–¥</span>
        </div>
        <h2>WordPress</h2>
        <div class="video-grid">
            <div class="loading-placeholder">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ...</div>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∏–¥–µ–æ -->
    <div id="video-page" class="app-content hidden video-view">
      <div class="back-button" onclick="hideVideoPage()">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
        </svg>
        <span>–ù–∞–∑–∞–¥</span>
      </div>
      
      <!-- –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫-–ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä —Å –ø—Ä–µ–≤—å—é -->
      <div class="video-placeholder"></div>
      <div class="video-info">
        <div class="video-description-container">
          <h1 class="video-title" id="video-title">–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ</h1>
          <div class="video-stats">
            <span id="video-views">0 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
            <span id="video-date">—Å–µ–≥–æ–¥–Ω—è</span>
          </div>
          <div class="video-description" id="video-description">
            –û–ø–∏—Å–∞–Ω–∏–µ –≤–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...
          </div>
        </div>
        <button id="watch-button" class="watch-button">–°–º–æ—Ç—Ä–µ—Ç—å</button>
      </div>
    </div>

    <!-- –î—Ä—É–≥–∏–µ —ç–∫—Ä–∞–Ω—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <div id="community-view" class="app-content hidden">
      <h1>–°–æ–æ–±—â–µ—Å—Ç–≤–æ</h1>
      <div class="community-cards">
        <div class="community-card" onclick="openRules()">
          <span>–ü—Ä–∞–≤–∏–ª–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</span>
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
        </div>
        <!-- –î–æ–±–∞–≤–∏–ª–∏ onclick -->
        <div class="community-card" onclick="openFaq()">
          <span>–û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã</span>
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
        </div>
        <div class="community-card">
          <div class="support-content">
              <span>–û–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ —Å–ª—É–∂–±—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏</span>
              <div class="support-divider"></div>
              <p class="support-hours">–†–∞–±–æ—Ç–∞–µ–º —Å –ø–Ω ‚Äì –ø—Ç –ø–æ 19.00 –ø–æ –º—Å–∫</p>
          </div>
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
        </div>
      </div>
    </div>

    <div id="rules-view" class="app-content hidden">
      <div class="back-button" onclick="hideRules()">
        <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
        <span>–ù–∞–∑–∞–¥</span>
      </div>
      <h1>–ü—Ä–∞–≤–∏–ª–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</h1>

      <div class="faq-item">
        <div class="question" onclick="toggleAnswer(this)">
          <div class="question-title">
            <span class="question-badge">1</span>
            –ù–µ —Å–ø–∞–º–∏—Ç—å
          </div>
          <svg class="faq-arrow" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
        </div>
        <div class="answer hidden">
          –ó–∞–ø—Ä–µ—â–µ–Ω–æ —Ä–∞–∑–º–µ—â–∞—Ç—å —Ä–µ–∫–ª–∞–º—É –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ —Å–º—ã—Å–ª–∞.
        </div>
      </div>

      <div class="faq-item">
        <div class="question" onclick="toggleAnswer(this)">
          <div class="question-title">
            <span class="question-badge">2</span>
            –ë—ã—Ç—å –≤–µ–∂–ª–∏–≤—ã–º
          </div>
          <svg class="faq-arrow" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
        </div>
        <div class="answer hidden">
          –û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è –∏ –≥—Ä—É–±–æ—Å—Ç—å –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã.
        </div>
      </div>

      <!-- ‚Ä¶–¥—Ä—É–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞‚Ä¶ -->
    </div>

    <!-- –ù–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ "–í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã" -->
    <div id="faq-view" class="app-content hidden">
      <div class="back-button" onclick="hideFaq()">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
        </svg>
        <span>–ù–∞–∑–∞–¥</span>
      </div>
      <h1>–í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã</h1>

      <div class="faq-item">
        <div class="question" onclick="toggleAnswer(this)">
          <div class="question-title">
            <span class="question-badge">1</span>
            –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ?
          </div>
          <svg class="faq-arrow" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
        </div>
        <div class="answer hidden">
          –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–∏–¥–µ–æ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç‚Ä¶
        </div>
      </div>

      <div class="faq-item">
        <div class="question" onclick="toggleAnswer(this)">
          <div class="question-title">
            <span class="question-badge">2</span>
            –ö–∞–∫ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ?
          </div>
          <svg class="faq-arrow" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
        </div>
        <div class="answer hidden">
          –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–µ—Ä–¥–µ—á–∫–æ –≤ —É–≥–ª—É –ø—Ä–µ–≤—å—é, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å‚Ä¶
        </div>
      </div>

      <!-- ‚Ä¶other items‚Ä¶ -->
    </div>

    <div id="favorites-view" class="app-content hidden">
        <h1>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h1>
        <div class="favorites-content">
            <div class="no-favorites">
                <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;">üíñ</div>
                <div style="font-size: 18px; margin-bottom: 8px; opacity: 0.8;">–ù–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ</div>
                <div style="font-size: 14px; opacity: 0.6;">–î–æ–±–∞–≤—å—Ç–µ –≤–∏–¥–µ–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ, –Ω–∞–∂–∞–≤ –Ω–∞ ‚ù§Ô∏è</div>
            </div>
        </div>
    </div>

    <!-- –≤–º–µ—Å—Ç–æ profile-view: —á–∞—Ç—ã -->
    <div id="chats-view" class="app-content hidden">
      <h1>–ß–∞—Ç—ã</h1>
      <div class="community-card chat-card" onclick="openGptChat()">
        <!-- –≤–º–µ—Å—Ç–æ <img> -->
        <div class="chat-avatar">ü§ñ</div>
        <div class="chat-info">
          <div class="chat-title">AI –ü–æ–º–æ—â–Ω–∏–∫</div>
          <div class="chat-description">–ó–∞–¥–∞–π—Ç–µ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å</div>
        </div>
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
        </svg>
      </div>
      <div class="community-card chat-card">
        <!-- –≤–º–µ—Å—Ç–æ <img> -->
        <div class="chat-avatar"></div>
        <div class="chat-info">
          <div class="chat-title">ks study</div>
          <div class="chat-description">–æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç</div>
        </div>
      </div>
    </div>

    <!-- GPT Chat View -->
    <div id="gpt-chat-view" class="app-content hidden">
        <div class="back-button chat-back-button" onclick="closeGptChat()">
            <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
            <span>ü§ñ AI –ü–æ–º–æ—â–Ω–∏–∫</span>
        </div>
        
        <div class="chat-container">
            <div class="chat-header">
                <div class="chat-actions">
                    <button class="chat-clear-btn" id="chat-clear-btn">–û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>
            </div>
            
            <div class="chat-messages" id="chat-messages">
                <div class="chat-empty">
                    <div class="chat-empty-icon">ü§ñ</div>
                    <div class="chat-empty-text">–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à AI –ø–æ–º–æ—â–Ω–∏–∫</div>
                    <div class="chat-empty-subtitle">–ó–∞–¥–∞–π—Ç–µ –º–Ω–µ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å</div>
                </div>
            </div>
            
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <textarea 
                        id="chat-input" 
                        class="chat-input" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å..."
                        rows="1"
                    ></textarea>
                    <button id="chat-send-btn" class="chat-send-btn">
                        ‚û§
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–∏—Å–∫–∞ -->
    <div id="search-modal" class="app-content hidden">
        <div class="search-header">
            <button class="close-search" onclick="closeSearch()">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
            <input type="text" class="search-input-modal" placeholder="–ü–æ–∏—Å–∫ –≤–∏–¥–µ–æ..." autofocus>
        </div>
        
        <div class="search-tabs">
            <div class="search-tab active" onclick="setSearchTab('all')">–í—Å–µ</div>
            <div class="search-tab" onclick="setSearchTab('html')">HTML + CSS</div>
            <div class="search-tab" onclick="setSearchTab('js')">JavaScript</div>
            <div class="search-tab" onclick="setSearchTab('php')">PHP</div>
            <div class="search-tab" onclick="setSearchTab('wordpress')">WordPress</div>
        </div>
        
        <div class="search-results">
            <div class="search-sorting">
                <span class="sort-option active" onclick="setSearchSort('new')">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ ‚ñº</span>
                <span class="sort-option" onclick="setSearchSort('old')">–°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ ‚ñº</span>
            </div>
            
            <div class="search-items">
                <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                <div class="no-results">–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞</div>
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
    <div class="tab-bar">
      <div class="tab active" onclick="switchTab('main')">–ì–ª–∞–≤–Ω–∞—è</div>
      <div class="tab" onclick="switchTab('community')">–°–æ–æ–±—â–µ—Å—Ç–≤–æ</div>
      <div class="tab" onclick="switchTab('favorites')">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
      <div class="tab" onclick="switchTab('chats')">–ß–∞—Ç—ã</div>
    </div>

    <script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
    <script src="/static/websocket-manager.js"></script>
    <script src="/static/gpt-chat.js"></script>
    <script src="/static/script.js"></script>
    
    <script>
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ (–Ω–µ –∏–∑–º–µ–Ω—è—è –æ—Å–Ω–æ–≤–Ω–æ–π script.js)
    function setSearchTab(tab) {
        currentSearchTab = tab;
        document.querySelectorAll('.search-tab').forEach(el => {
            el.classList.remove('active');
            if (el.textContent.toLowerCase().includes(tab) || (tab === 'all' && el.textContent.toLowerCase() === '–≤—Å–µ')) {
                el.classList.add('active');
            }
        });
        updateSearchResults();
    }

    function setSearchSort(sort) {
        currentSearchSort = sort;
        document.querySelectorAll('.sort-option').forEach(el => {
            el.classList.remove('active');
        });
        event.target.classList.add('active');
        updateSearchResults();
    }

    function setupSearchInput() {
        const searchInputModal = document.querySelector('.search-input-modal');
        if (searchInputModal) {
            searchInputModal.addEventListener('input', function() {
                updateSearchResults();
            });
        }
    }

    function initializeTagFilter() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–≥–æ–≤ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ
        console.log('–¢–µ–≥–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
    }

    function toggleAnswer(questionElement) {
        const answer = questionElement.nextElementSibling;
        const arrow = questionElement.querySelector('.faq-arrow');
        
        if (answer && answer.classList.contains('answer')) {
            if (answer.classList.contains('hidden')) {
                answer.classList.remove('hidden');
                arrow.classList.add('open');
                questionElement.classList.add('active');
            } else {
                answer.classList.add('hidden');
                arrow.classList.remove('open');
                questionElement.classList.remove('active');
            }
        }
    }

    // –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ò–ó–ë–†–ê–ù–ù–û–ì–û
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ (—É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
    async function toggleFavoriteEnhanced(videoId, event) {
        event.stopPropagation();
        const star = event.target;
        
        const videoIdStr = videoId.toString();
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
        star.classList.add('adding');
        setTimeout(() => star.classList.remove('adding'), 600);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        if (favoriteVideos.includes(videoIdStr)) {
            favoriteVideos = favoriteVideos.filter(id => id !== videoIdStr);
            star.classList.remove('active');
            star.textContent = '‚ù§';
            console.log(`–í–∏–¥–µ–æ ${videoId} —É–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ`);
        } else {
            favoriteVideos.push(videoIdStr);
            star.classList.add('active');
            star.textContent = '‚ù§';
            console.log(`–í–∏–¥–µ–æ ${videoId} –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ`);
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
        localStorage.setItem('favorites', JSON.stringify(favoriteVideos));
        
        // –ï—Å–ª–∏ –º—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ, –æ–±–Ω–æ–≤–ª—è–µ–º –µ—ë
        if (currentPage === 'favorites') {
            displayFavoriteVideos();
        }
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
        try {
            const response = await fetch(`${API_BASE}/favorites/toggle/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCsrfToken()
                },
                body: JSON.stringify({
                    video_id: videoId
                })
            });
            
            if (response.ok) {
                const result = await response.json();
                console.log('–°—Ç–∞—Ç—É—Å –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å —Å–µ—Ä–≤–µ—Ä–æ–º:', result);
            }
        } catch (error) {
            console.log('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º:', error);
        }
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ
    function displayFavoriteVideos() {
        const favoritesContent = document.querySelector('.favorites-content');
        if (!favoritesContent) return;
        
        const favoriteVideosList = [];
        const addedVideoIds = new Set(); // –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ
        
        console.log('–¢–µ–∫—É—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ loadedVideos:', Object.keys(loadedVideos));
        console.log('–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ IDs:', favoriteVideos);
        
        // –°–æ–±–∏—Ä–∞–µ–º –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ –∏–∑ –≤—Å–µ—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        for (const category in loadedVideos) {
            const videos = loadedVideos[category] || [];
            console.log(`–ö–∞—Ç–µ–≥–æ—Ä–∏—è ${category}:`, videos.length, '–≤–∏–¥–µ–æ');
            
            videos.forEach(video => {
                const videoIdStr = video.id.toString();
                console.log(`–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏–¥–µ–æ ${videoIdStr} –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${category}`);
                
                if (favoriteVideos.includes(videoIdStr) && !addedVideoIds.has(videoIdStr)) {
                    console.log(`–î–æ–±–∞–≤–ª—è–µ–º –≤–∏–¥–µ–æ ${videoIdStr} –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${category}`);
                    favoriteVideosList.push({
                        ...video,
                        categoryName: getCategoryDisplayName(category)
                    });
                    addedVideoIds.add(videoIdStr); // –û—Ç–º–µ—á–∞–µ–º –∫–∞–∫ –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–µ
                } else if (favoriteVideos.includes(videoIdStr) && addedVideoIds.has(videoIdStr)) {
                    console.log(`–í–∏–¥–µ–æ ${videoIdStr} —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º`);
                }
            });
        }
        
        console.log('–ò—Ç–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ:', favoriteVideosList.length);
        console.log('–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ ID –≤–∏–¥–µ–æ:', Array.from(addedVideoIds));
        
        if (favoriteVideosList.length === 0) {
            favoritesContent.innerHTML = `
                <div class="no-favorites">
                    <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;">üíñ</div>
                    <div style="font-size: 18px; margin-bottom: 8px; opacity: 0.8;">–ù–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ</div>
                    <div style="font-size: 14px; opacity: 0.6;">–î–æ–±–∞–≤—å—Ç–µ –≤–∏–¥–µ–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ, –Ω–∞–∂–∞–≤ –Ω–∞ ‚ù§Ô∏è</div>
                </div>
            `;
            return;
        }
        
        // –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        const statsHtml = `
            <div class="favorites-stats">
                <h3>–ò–∑–±—Ä–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ: ${favoriteVideosList.length}</h3>
                <p>–í–∏–¥–µ–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –≤–∞—à–µ–π –ª–∏—á–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏</p>
            </div>
        `;
        
        // –°–æ–∑–¥–∞–µ–º —Å–µ—Ç–∫—É –≤–∏–¥–µ–æ
        const videosHtml = favoriteVideosList.map(video => `
            <div class="video-thumbnail" onclick="openVideoPage('${video.id}', ${JSON.stringify(video).replace(/"/g, '&quot;')})">
                <span class="favorite-star active" data-video-id="${video.id}" onclick="toggleFavoriteEnhanced('${video.id}', event)">‚ù§</span>
                <img src="${video.preview_image || `https://via.placeholder.com/300x169?text=${encodeURIComponent(video.title)}`}" 
                     alt="${video.title}"
                     onerror="this.src='https://via.placeholder.com/300x169?text=–í–∏–¥–µ–æ'">
                <div class="video-info">
                    <h3>${video.title}</h3>
                    <p>${video.description ? (video.description.length > 60 ? video.description.substring(0, 60) + '...' : video.description) : ''}</p>
                    <div class="video-category-tag">${video.categoryName}</div>
                </div>
            </div>
        `).join('');
        
        favoritesContent.innerHTML = `
            ${statsHtml}
            <div class="favorites-grid">
                ${videosHtml}
            </div>
        `;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–≤–µ–∑–¥–æ—á–µ–∫
        updateFavoriteStars();
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–≥–æ –∏–º–µ–Ω–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    function getCategoryDisplayName(category) {
        const categoryNames = {
            'html_css': 'HTML + CSS',
            'html': 'HTML + CSS',
            'javascript': 'JavaScript',
            'js': 'JavaScript',
            'php': 'PHP',
            'wordpress': 'WordPress'
        };
        return categoryNames[category] || category;
    }

    // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º toggleFavorite –≥–ª–æ–±–∞–ª—å–Ω–æ
    window.toggleFavorite = toggleFavoriteEnhanced;
    
    // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º switchTab –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
    const originalSwitchTab = window.switchTab;
    window.switchTab = function(tabName) {
        if (tabName === 'favorites') {
            currentPage = tabName;
            currentCategory = null;
            
            hideAllViews();

            const viewId = `${tabName}-view`;
            const targetView = document.getElementById(viewId);
            if (targetView) {
                targetView.classList.add('view');
                targetView.classList.remove('hidden');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ
                displayFavoriteVideos();
            }

            setActiveTab(tabName);
        } else {
            // –í—ã–∑—ã–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –≤–∫–ª–∞–¥–æ–∫
            originalSwitchTab(tabName);
        }
    };
    </script>
</body>
</html>